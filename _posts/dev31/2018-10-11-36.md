---
title: "[Web] Browser의 렌더링 과정"
date: 2018-10-11 09:00:00 +0900
comments: true
category: dev
sub: etc
tags: [web, browser, rendering]
---

우리는 컴퓨터로 그리고 스마트폰으로 하루에도 수십번씩 웹 브라우저를 사용한다.
브라우저를 키고 네이버나 구글 같은 웹 페이지에 접속을 한다.
그럼 브라우저는 HTTP나 HTTPS 통신으로
HTML과 CSS, JS 파일 등 해당 웹 페이지에 필요한 리소스들을 불러오기 시작한다.
그리고나서 브라우저는 리소스들을 처리하기 시작하여 실제 사용자가 보는 화면에 띄워준다.

이번에 설명할 것은 브라우저가 리소스들을 받아 어떻게 처리하는지에 대해 설명한다.
이것을 이해하면 웹 개발을 할 때 최초 페이지가 띄워지기 까지 걸리는 시간을 최적화할 수 있다.

---

## 렌더링 엔진

렌더링 엔진의 역할은 요청 받은 내용을 브라우저 화면에 표시하는 일을 담당한다.
보통 HTML 이나 이미지 들을 표시할 수 있다.

이러한 렌더링 엔진은 브라우저마다 존재한다.
대표적으로 파이어폭스는 모질라에 자체 제작 한 게코(Gecko) 엔진을 사용하며,
사파리와 크롬은 웹킷(Webkit) 엔진을 사용한다.

이러한 렌더링 엔진은 전부다 똑같지 않고, 엔진마다 미세한 차이가 존재한다.
때문에 우리가 같은 웹 사이트를 접속할때 브라우저 마다 미세한 차이가 존재하는 이유도
브라우저에 사용되는 렌더링 엔진이 달라서 생기는 현상이다.

---

## 렌더링 엔진 동작 과정

### 1. 파싱 (Parsing)
먼저 브라우저가 HTML 파일을 디스크나 네트워크에서 읽어온 뒤 해당 파일에 지정된 인코딩(예:UTF-8)으로 변환한다.

다음으로 HTML 파일 문자열을 [W3C HTML5 표준](https://www.w3.org/TR/html5/)에 지정된 고유 토큰으로 변환한다.
예를들면 `<html>`, `<body>` 같이 흔히 말하는 태그에 사용되는 문자열을 토큰화 하는 것이다.

만들어진 토큰은 해당 속성 및 규칙을 정의하는 객체로 다시 변환된다.
여기서 만들어진 객체는 우리가 흔히 말하는 태그라고 한다.

마지막으로 DOM을 생성한다.

먼저 다운받은 HTML 파일을 분석하여 DOM(Document Object Model) 이라는 객체를 생성한다.
그리고 DOM 객체를 부모-자식 관계로 연결해 트리 구조로 만든다.
이것을 **DOM 트리** 라고 한다.

<br/>

<p class="center"><img class="radius center" style="width:40rem;" src="/dev/36/dom-tree.png"></p>

<p class="center desc">DOM 트리</p>

<br>

하지만 HTML 파일에는 이러한 DOM 객체만 존재하는건 아니다.
`<script>`, `<link>`, `<img>` 같은 자바스크립트나 CSS 파일, 이미지 파일도 존재할 수 있다.
이러한 리소스들도 파싱 단계에서 모두 요청하여 다운을 받는다.

그 중에서 `<style>` 태그로 CSS가 인라인으로 있거나, 별도의 CSS 파일을 다운 받으면
파싱 단계에서 CSS 또한 분석하여 트리 구조로 만든다.
이것은 **CSSOM 트리** 라고 한다.

<br/>

<p class="center"><img class="radius center" style="width:40rem;" src="/dev/36/cssom-tree.png"></p>

<p class="center desc">CSSOM 트리</p>

<br>

### 2. 스타일 (Style)

### 3. 레이아웃 (Layout)

### 4. 페인트 (Paint)

### 5. 합성 및 렌더 (Composite & Render)
