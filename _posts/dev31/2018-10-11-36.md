---
title: "[Web] Browser의 렌더링 과정"
date: 2018-10-11 09:00:00 +0900
comments: true
category: dev
sub: etc
tags: [web, browser, rendering]
---

우리는 컴퓨터로 그리고 스마트폰으로 하루에도 수십번씩 웹 브라우저를 사용한다.
브라우저를 키고 네이버나 구글 같은 웹 페이지에 접속을 한다.
그럼 브라우저는 HTTP나 HTTPS 통신으로
HTML과 CSS, JS 파일 등 해당 웹 페이지에 필요한 리소스들을 불러오기 시작한다.
그리고나서 브라우저는 리소스들을 처리하기 시작하여 실제 사용자가 보는 화면에 띄워준다.

이번에 설명할 것은 브라우저가 리소스들을 받아 어떻게 처리하는지에 대해 설명한다.
이것을 이해하면 웹 개발을 할 때 최초 페이지가 띄워지기 까지 걸리는 시간을 최적화할 수 있다.

---

# 렌더링 엔진

렌더링 엔진의 역할은 요청 받은 내용을 브라우저 화면에 표시하는 일을 담당한다.
보통 HTML 이나 이미지 들을 표시할 수 있다.

이러한 렌더링 엔진은 브라우저마다 존재한다.
대표적으로 파이어폭스는 모질라에 자체 제작 한 게코(Gecko) 엔진을 사용하며,
사파리와 크롬은 웹킷(Webkit) 엔진을 사용한다.

이러한 렌더링 엔진은 전부다 똑같지 않고, 엔진마다 미세한 차이가 존재한다.
때문에 우리가 같은 웹 사이트를 접속할때 브라우저 마다 미세한 차이가 존재하는 이유도
브라우저에 사용되는 렌더링 엔진이 달라서 생기는 현상이다.

---

# 렌더링 엔진 동작 과정

## 1. 파싱 (Parsing)

### 1-1. 변환 (Conversion)
브라우저가 HTML 파일을 디스크나 네트워크에서 읽어온 뒤 해당 파일에 지정된 인코딩(예:UTF-8)으로 변환한다.

### 1-2. 토큰화 (Tokenizing)
다음으로 HTML 파일 문자열을 [W3C HTML5 표준](https://www.w3.org/TR/html5/)에 지정된 고유 토큰으로 변환한다.
예를들면 `<html>`, `<body>` 같이 흔히 말하는 태그에 사용되는 문자열을 토큰화 하는 것이다.
이런 각각의 토큰들은 특별한 의미와 고유한 규칙을 가진다.

### 1-3. 렉싱 (Lexing)
반환된 토큰은 각각의 속성 및 규칙을 정의하는 '객체'로 변환된다.

### 1-4. DOM 생성 (DOM construction)
마지막으로 생성된 객체를 트리 데이터 구조로 연결시킨다.
이 트리 데이터 구조는 부모-자식 관계도 포함되며, 우리가 알고있는 HTML이 생성되는 것이다.

여기까지 생성된 결과물이 **DOM(Document Object Model)** 이라 하며,
트리 구조로 되어 있어서 **DOM 트리** 라고도 한다.

<br/>

<p class="center"><img class="radius center" style="width:40rem;" src="/dev/36/dom-tree.png"></p>

<p class="center desc">DOM 트리</p>

<br>

### 1-5. CSSOM (CSS Object Model)
브라우저가 HTML을 파싱하는 과정에서 대부분은 head 태그의 하위로 link 태그가 존재해 CSS 파일을 불러오게 된다.
CSS 파일을 불러온 뒤, HTML과 마찬가지로 브라우저가 이해하고 처리할 수 있는 형식으로 변환해야 한다.

그 과정은 DOM을 생성하는 과정과 동일하다. 단 출력된 결과는 CSSOM(CSS Object Model) 이라고 부르며,
DOM 트리와 마찬가지로 트리 구조로 되어있어 CSSOM 트리 라고도 부른다.

<br/>

<p class="center"><img class="radius center" style="width:40rem;" src="/dev/36/cssom-tree.png"></p>

<p class="center desc">CSSOM 트리</p>

<br>

CSSOM 트리는 하향식으로 적용된다는 규칙을 가지고 있다.
예를들면 body 요소의 하위인 경우에는 모두 body 스타일이 적용된다는 것이다.

또한 각각 브라우저마다 `User-Agent Style` 이라고 하는 기본 스타일이 정의되어있다.
이 스타일은 개발자가 스타일을 지정하지 않을 경우 브라우저에서 제공하는 기본 스타일이다.

### 2. 스타일 (Style)

### 3. 레이아웃 (Layout)

### 4. 페인트 (Paint)

### 5. 합성 및 렌더 (Composite & Render)
